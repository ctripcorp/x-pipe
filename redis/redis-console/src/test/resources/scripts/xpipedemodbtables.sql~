-- Xpipe DB Demo

-- DC Table
create table DC_TBL
(
	id bigint unsigned not null auto_increment primary key comment 'primary key',
	dc_id varchar(30) not null unique comment 'dc id', 
	dc_active tinyint(1) not null default 1 comment 'dc active status',
	dc_description varchar(180) not null default 'nothing' comment 'dc description',
    dc_last_modified_time varchar(20) not null default '' comment 'last modified tag',
    DataChange_LastTime timestamp default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP comment 'last modified time'
);


-- Meta Server Table
create table METASERVER_TBL
(
	id bigint unsigned not null auto_increment primary key comment 'primary key',
	metaserver_id varchar(30) not null unique comment 'metaserver id',
	dc_id varchar(30) not null comment 'dc id',
	metaserver_ip varchar(40) not null comment 'metaserver ip',
	metaserver_port int not null comment 'metaserver port',
	metaserver_active tinyint(1) default 1 not null comment 'metaserver active status',
	metaserver_role varchar(12) not null default 'slave' comment 'metaserver role',
    DataChange_LastTime timestamp default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP comment 'last modified time'
);

-- Setinel Table
create table SETINEL_TBL
(
	setinel_id bigint unsigned not null auto_increment primary key comment 'setinel id',
    dc_id varchar(30) not null comment 'dc id',
    setinel_address varchar(80) not null comment 'setinel address',
    setinel_description varchar(120) not null default 'nothing' comment 'setinel description',
    DataChange_LastTime timestamp default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP comment 'last modified time'
);

-- Cluster Table
create table CLUSTER_TBL
(
	id bigint unsigned not null auto_increment primary key comment 'primary key',
	cluster_id varchar(30) not null unique comment 'cluster id',
	activedc_id varchar(30) not null comment 'active dc id',
	cluster_description varchar(180) not null default 'nothing' comment 'cluster description',
    cluster_last_modified_time varchar(20) not null default '' comment 'last modified tag',
    DataChange_LastTime timestamp default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP comment 'last modified time'
);


-- DC Cluster Table
create table DC_CLUSTER_TBL 
(
	dc_cluster_id bigint unsigned not null auto_increment primary key comment 'primary key',
	dc_id varchar(30) not null comment 'dc id',
	cluster_id varchar(30) not null comment 'cluster id',
	metaserver_id varchar(30) not null comment 'metaserver id',
    dc_cluster_phase int not null default 1 comment 'dc cluster phase',
    DataChange_LastTime timestamp default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP comment 'last modified time'
);

-- Shard Table
create table SHARD_TBL
(
	id bigint unsigned not null auto_increment primary key comment 'primary key',
	shard_id varchar(30) not null comment 'shard id',
	cluster_id varchar(30) not null comment 'cluster id',
    DataChange_LastTime timestamp default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP comment 'last modified time'
);


-- DC Cluster Shard Table
create table DC_CLUSTER_SHARD_TBL
(
	dc_cluster_shard_id bigint unsigned not null auto_increment primary key comment 'primary key',
	dc_cluster_id bigint not null comment 'dc cluster id',
	shard_id varchar(30) not null comment 'shard id',
    setinel_id bigint not null comment 'setinel id',
    setinel_monitor_name varchar(30) not null default 'default' comment 'setinel monitor name',
    dc_cluster_shard_phase int not null default 1 comment 'structure phase',
    DataChange_LastTime timestamp default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP comment 'last modified time'
);


-- Redis Table
create table REDIS_TBL
(
	id bigint unsigned not null auto_increment primary key comment 'primary key',
	redis_id varchar(80) not null comment 'redis id',
	dc_cluster_shard_id bigint not null comment 'dc cluster shard id',
	redis_ip varchar(40) not null comment 'redis ip',
	redis_port int not null comment 'redis port',
	redis_role varchar(12) not null default 'slave' comment 'redis role',
	redis_active tinyint(1) not null default 1 comment 'redis active status',
	redis_master varchar(80) not null default '' comment 'redis master',
	keepercontainer_id bigint comment 'keepercontainer id',
    DataChange_LastTime timestamp default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP comment 'last modified time'
);


-- Keeper Container Table
create table KEEPERCONTAINER_TBL
(
	keepercontainer_id bigint unsigned not null auto_increment primary key comment 'primary key',
    keepercontainer_dc varchar(30) not null comment 'keepercontainer dc',
	keepercontainer_ip varchar(40) not null comment 'keepercontainer ip',
	keepercontainer_port int not null comment 'keepercontainer port',
	keepercontainer_active tinyint(1) not null default 1 comment 'keepercontainer active status',
    DataChange_LastTime timestamp default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP comment 'last modified time'cluster_tblcluster_tbl
);
